<script>
  const clientId = '4vu39fr2kccnb6kdk67v8ejsak';
  const redirectUri = 'https://cloudtechmadan.github.io/my-website-user/index.html';
  const domain = 'https://face-attendance-admin-auth.auth.us-east-1.amazoncognito.com'; // Replace with your actual domain

  // Check for access_token in URL (after login redirect)
  const urlParams = new URLSearchParams(window.location.search);
  const code = urlParams.get('code');

  if (code) {
    // Exchange code for tokens
    fetch(`https://${domain}/oauth2/token`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: `grant_type=authorization_code&client_id=${clientId}&code=${code}&redirect_uri=${redirectUri}`
    })
      .then(res => res.json())
      .then(data => {
        if (data.access_token) {
          localStorage.setItem('accessToken', data.access_token);
          window.location.href = 'dashboard.html'; // Authenticated page
        }
      });
  } else {
    // If no code or token, redirect to login
    const loginUrl = `https://${domain}/login?response_type=code&client_id=${clientId}&redirect_uri=${redirectUri}`;
    window.location.href = loginUrl;
  }
</script>
